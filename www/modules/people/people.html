<ion-view>
  <ion-nav-title>
    People
  </ion-nav-title>
  <ion-nav-buttons side="right">
    <button class="button button-icon button-clear ion-home" ui-sref="app.profile">
    </button>
  </ion-nav-buttons>
  <ion-pane>
    <ion-tabs class="tabs-top bar-positive">

      <ion-tab id="contacts-tab" title="Contacts {{ vm.isCurrentState('app.people.contacts') ? '*' : '' }}" ng-if="vm.usingDevice()" ui-sref="app.people.contacts">
        <ion-nav-view name="feed">
          <ion-content>
            <div>{{ vm.contacts.length > 0 ? "Select one of the contacts below:" : "You have no contacts" }}</div>


            <ion-list ng-repeat="contact in vm.contacts | orderBy: '-addedAt'">
              <div class="item item-avatar item-button-right" ng-click="vm.showProfileOrOpenAddUserModal(contact)">
                <img ng-src="{{ contact.user ? contact.user.face : '' }}">
                <h2>{{ contact.displayName }}</h2>
                <div ng-if="contact.user">
                  <div>In Public As:</div>
                  <h2>{{ contact.user.name }}</h2>
                  <h2>{{ contact.user.username }}</h2>

                  <button class="button button-positive"
                      ng-click="vm.toggleListening(contact.user, $event)"
                      ng-show="!vm.listeningTo(contact.user)">Listen</button>

                  <button class="button button-energized"
                      ng-click="vm.toggleListening(contact.user, $event)"
                      ng-show="vm.listeningTo(contact.user)">Unlisten</button>

                </div>
              </div>
            </ion-list>
          </ion-content>
        </ion-nave>
      </ion-tab>

      <ion-tab id="listenees-tab" title="Listenees {{ vm.isCurrentState('app.people.listenees') ? '*' : '' }}" ng-if="true" ui-sref="app.people.listenees">
        <ion-nav-view name="listenees">
          <ion-content>
            <ion-list ng-repeat="listeneeStub in vm.listeneeStubs | orderBy: '-addedAt'">
                <div class="item item-avatar item-button-right" ng-click="vm.showProfile(listeneeStub)">
                <img ng-src="{{ vm.listenee(listeneeStub).face }}">
                <h2>{{ vm.listenee(listeneeStub).name }}</h2>
                <h2>{{ vm.listenee(listeneeStub).username }}</h2>

                <button class="button button-positive"
                    ng-click="vm.toggleListening(listeneeStub, $event)"
                    ng-show="!vm.listeningTo(listeneeStub)">Listen</button>

                <button class="button button-energized"
                    ng-click="vm.toggleListening(listeneeStub, $event)"
                    ng-show="vm.listeningTo(listeneeStub)">Unlisten</button>
              </div>
            </ion-list>
          </ion-content>
        </ion-nav-view>
      </ion-tab>

      <ion-tab id="search-results-tab" title="Search Results {{ vm.isCurrentState('app.people.searchResults') ? '*' : '' }}" ng-if="vm.showSearchResultsTab" ui-sref="app.people.searchResults">
        <ion-nav-view name="search-results">
          <ion-content>
            <ion-list ng-repeat="user in vm.searchResults | orderBy: '-addedAt'">
                <div class="item item-avatar item-button-right" ng-click="vm.showProfile(user)">
                <img ng-src="{{ user.face }}">
                <h2>{{ user.name }}</h2>
                <h2>{{ user.username }}</h2>

                <button class="button button-positive"
                    ng-click="vm.toggleListening(user, $event)"
                    ng-show="!vm.listeningTo(user)">Listen</button>

                <button class="button button-energized"
                    ng-click="vm.toggleListening(user, $event)"
                    ng-show="vm.listeningTo(user)">Unlisten</button>

              </div>

            </ion-list>

            <div>
              <span ng-if="vm.searchResults.length">
                None of those users is the one you're looking for?
              </span>
              <span ng-if="!vm.searchResults.length">
                No matching users found.
              </span>
              <button class="btn btn-primary" ng-click="vm.createUser()">Add User To Public</button>
            </div>

          </ion-content>
        </ion-nav-view>
      </ion-tab>

    </ion-tabs>
  </ion-pane>

  <ion-footer-bar class="item-input-inset bar-positive">
    <form name="SearchForm">
      <fieldset>
        <div class="form-group">
          <input id="search-text" ng-model="vm.searchText" class="form-control pull-left" placeholder="Enter user name or username" required>
          <button class="btn btn-primary pull-right" ng-disabled="SearchForm.$invalid" ng-click="vm.search();">Search Public</button>
        </div>
      </fieldset>
    </form>
  </ion-footer-bar>

</ion-view>