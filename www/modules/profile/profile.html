<ion-view>
  <ion-nav-title>
    <div class="user-div">
      <img class="user-avatar" ng-src="{{ vm.user.face }}">
      <span class="user-profile-name">{{ vm.user.name }}</span>
      <p class="user-username">{{ vm.user.username }}</p>
    </div>
  </ion-nav-title>
  <ion-pane>
    <ion-tabs class="tabs-top bar-positive">

      <ion-tab id="feed-tab" title="Newsfeed" ng-if="vm.viewingOwnProfile()">
        <ion-nav-view name="feed">
          <ion-content>
            <ion-list ng-repeat="message in vm.feedMessages | orderBy: '-createdAt'">
              <div class="item item-avatar" ng-click="vm.showMessage(message)">
                <img ng-src="{{ vm.author(message).face }}">
                <div>
                  <h2>
                    <strong>{{ vm.author(message).name }}</strong> said
                    <span ng-if="message.authorUserId != messge.subjectUserId">
                      to <strong>{{ vm.subject(message).name || vm.subject(message).username }}</strong>
                    </span>
                    <span class="post-createdAt">{{ vm.createdAtRelative(message) }}</span>
                  </h2>
                  <p>
                    <em>{{ message.text }}</em>
                  </p>
                </div>
              </div>
            </ion-list>
          </ion-content>
        </ion-nav-view>
      </ion-tab>

      <ion-tab id="messages-tab" title="{{ vm.viewingOwnProfile() ? 'Your Messages' : 'Messages' }}" ng-if="true">
        <ion-nav-view name="messages">
          <ion-content>
            <ion-list ng-repeat="message in vm.profileMessages | orderBy: '-createdAt'">
              <div class="item item-avatar" ng-click="vm.showMessage(message)">
                <img ng-src="{{ vm.author(message).face }}">
                <div>
                  <h2>
                    <strong>{{ vm.author(message).name }}</strong> said
                    <span ng-if="message.authorUserId != messge.subjectUserId">
                      to <strong>{{ vm.subject(message).name || vm.subject(message).username }}</strong>
                    </span>
                    <span class="post-createdAt">{{ vm.createdAtRelative(message) }}</span>
                  </h2>
                  <p>
                    <em>{{ message.text }}</em>
                  </p>
                </div>
              </div>
            </ion-list>
          </ion-content>
        </ion-nav-view>
      </ion-tab>

      <ion-tab id="listeners-tab" title="Listeners" ng-if="true">
        <ion-nav-view name="listeners">
          <ion-content>
            <ion-list ng-repeat="listenerStub in vm.listenerStubs | orderBy: '-addedAt'">
                <div class="item item-avatar item-button-right" ng-click="vm.showProfile(listener)">
                <img ng-src="{{ vm.listener(listenerStub).face }}">
                <h2>{{ vm.listener(listenerStub).name }}</h2>
                <h2>{{ vm.listener(listenerStub).username }}</h2>

                <button class="button button-positive"
                    ng-click="vm.toggleListening(listenerStub, $event)"
                    ng-show="!vm.listeningTo(listenerStub)">Listen</button>

                <button class="button button-energized"
                    ng-click="vm.toggleListening(listenerStub, $event)"
                    ng-show="vm.listeningTo(listenerStub)">Unlisten</button>

              </div>

            </ion-list>
          </ion-content>
        </ion-nav-view>
      </ion-tab>

    </ion-tabs>
  </ion-pane>
  
  <ion-footer-bar align-title="left" class="post-footer bar-light">
    <textarea class="title" type="text" ng-model="vm.newMessage" placeholder="What do you want to say {{ vm.viewingOwnProfile() ? '' : 'to ' + vm.user.name + ' ' }}in Public?"></textarea>
    </
    <div class="buttons">
      <button class="button button-positive"
              ng-click="vm.postMessage()">Post</button>
    </div>
  </ion-footer-bar>

</ion-view>